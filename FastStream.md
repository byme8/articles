Доброго времени суток! 
Я бы сказал что для C# и .Net с выходом .Net Standart и dotnet core 3 наступает новая эпоха. Появляются новые API которые призваные ускорить как написание кода, так и его выполнение. Одним из таких нововедений является ``` ArrayPool ```, который появился в .Net Standart 2.1. И вот розмышляя над тем, где бы его заиспользовать, было решено проверить можно ли при его помощи ускорить производительность банального ``` MemoryStream ```. 

Кому интересно посмотреть что из этого получилось прошу под кат.

<cut />

Что такое ``` ArrayPool ``` и зачем вообще он нужен? По сути это обычный класс, который не зависит рантайма или фрейворка. При его помощи можно добиться переиспользования памяти на уровне приложения, тем самым с економив время на алокацию и сборку мусора. В некоторых ситуациях может дать существеный прирост скорости выполнения. Это достигается за счет преалоцирования буферов, которые выдаються в "аредну" при необходимы и возвращаються когда уже больше не нужны.

Вернемся к нашему ``` MemoryStream ```. Класический метод использования может иметь следующий вид:

``` cs
var values = new double[] { ... };

using (var memory = new MemoryStream())
using (var writer = new BinaryWriter(memory))
{
    writer.Write(values.Length);
    for (int i = 0; i < values.Length; i++)
    {
        writer.Write(values[i]);
    }

    File.WriteAllBytes("file.bin");
}
```

